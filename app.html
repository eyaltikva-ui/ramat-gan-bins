<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¡×¤×™×¨×ª ×¤×—×™ ××™×—×–×•×¨ - ×¨××ª ×’×Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }
        
        .subtitle {
            color: #718096;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #2d3748;
            font-weight: 600;
            font-size: 14px;
        }
        
        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .number-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-counter {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-minus {
            background: #fc8181;
            color: white;
        }
        
        .btn-minus:hover {
            background: #f56565;
            transform: scale(1.05);
        }
        
        .btn-plus {
            background: #68d391;
            color: white;
        }
        
        .btn-plus:hover {
            background: #48bb78;
            transform: scale(1.05);
        }
        
        .btn-minus:active, .btn-plus:active {
            transform: scale(0.95);
        }
        
        input[type="number"] {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            flex: 1;
        }
        
        /* Hide number input arrows */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        .btn-submit {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-submit:active {
            transform: translateY(0);
        }
        
        .btn-submit:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-gps {
            padding: 12px 20px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .btn-gps:hover {
            background: #3182ce;
            transform: scale(1.05);
        }
        
        .btn-gps:active {
            transform: scale(0.95);
        }
        
        .location-status {
            background: #bee3f8;
            color: #2c5282;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 13px;
            text-align: center;
            display: none;
        }
        
        .street-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #667eea;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .street-dropdown.show {
            display: block;
        }
        
        .street-option {
            padding: 12px 15px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .street-option:last-child {
            border-bottom: none;
        }
        
        .street-option:hover {
            background: #f7fafc;
        }
        
        .street-option.selected {
            background: #e6f0ff;
            font-weight: bold;
        }
        
        .no-results {
            padding: 12px 15px;
            color: #718096;
            text-align: center;
        }
        
        #streetSearch {
            border-radius: 10px;
        }
        
        #streetSearch:focus {
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        #streetSearch.has-value {
            border-color: #48bb78;
        }
        
        .success-message {
            background: #c6f6d5;
            color: #22543d;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .error-message {
            background: #fed7d7;
            color: #742a2a;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .loading {
            text-align: center;
            color: #718096;
            margin-top: 20px;
            display: none;
        }
        
        .spinner {
            border: 3px solid #e2e8f0;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        
        .stats-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stats-label {
            color: #718096;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—‘ï¸ ×¡×¤×™×¨×ª ×¤×—×™ ××™×—×–×•×¨</h1>
        <div class="subtitle">×¢×™×¨×™×™×ª ×¨××ª ×’×Ÿ</div>
        
        <form id="binForm">
            <div class="form-group">
                <label for="streetSearch">×¨×—×•×‘</label>
                <div style="display: flex; gap: 10px;">
                    <div style="flex: 1; position: relative;">
                        <input 
                            type="text" 
                            id="streetSearch" 
                            placeholder="×—×¤×© ××• ×‘×—×¨ ×¨×—×•×‘..."
                            autocomplete="off"
                            required
                        >
                        <input type="hidden" id="street" name="street">
                        <div id="streetDropdown" class="street-dropdown"></div>
                    </div>
                    <button type="button" class="btn-gps" onclick="getLocation()" title="××œ× ×›×ª×•×‘×ª ××•×˜×•××˜×™×ª ×œ×¤×™ ××™×§×•×">
                        ğŸ“ GPS
                    </button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="houseNumber">××¡×¤×¨ ×‘×™×ª</label>
                <input type="text" id="houseNumber" placeholder="×œ××©×œ: 15" required>
            </div>
            
            <div class="form-group">
                <label for="binCount">××¡×¤×¨ ×¤×—×™× ×›×—×•×œ×™×</label>
                <div class="number-input-group">
                    <button type="button" class="btn-counter btn-minus" onclick="decrementBins()">-</button>
                    <input type="number" id="binCount" min="0" value="0" required>
                    <button type="button" class="btn-counter btn-plus" onclick="incrementBins()">+</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="notes">×”×¢×¨×•×ª (××•×¤×¦×™×•× ×œ×™)</label>
                <input type="text" id="notes" placeholder="×”×¢×¨×•×ª × ×•×¡×¤×•×ª...">
            </div>
            
            <button type="submit" class="btn-submit" id="submitBtn">×©××•×¨ ×“×™×•×•×—</button>
        </form>
        
        <div class="location-status" id="locationStatus"></div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="margin-top: 10px;">×©×•××¨...</p>
        </div>
        
        <div class="success-message" id="successMessage">
            âœ… ×”×“×™×•×•×— × ×©××¨ ×‘×”×¦×œ×—×”!
        </div>
        
        <div class="error-message" id="errorMessage">
            âŒ ×©×’×™××” ×‘×©××™×¨×ª ×”×“×™×•×•×—
        </div>
        
        <div class="stats">
            <div class="stats-number" id="todayCount">0</div>
            <div class="stats-label">×“×™×•×•×—×™× ×”×™×•×</div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getDatabase, ref, push, set, query, orderByChild, startAt, endAt, get } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB1Bc2XO_QIvpo_2Ki7iGUXfhZQdkWHxr4",
            authDomain: "resource-reporting-8c7aa.firebaseapp.com",
            databaseURL: "https://resource-reporting-8c7aa-default-rtdb.firebaseio.com",
            projectId: "resource-reporting-8c7aa",
            storageBucket: "resource-reporting-8c7aa.firebasestorage.app",
            messagingSenderId: "597101026013",
            appId: "1:597101026013:web:354809104e0948cd6fd934",
            measurementId: "G-9ZM04YXJ9X"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // ×¨×©×™××ª ×¨×—×•×‘×•×ª ×¨××ª ×’×Ÿ
        const streets = [
            "××‘× ×‘×¨×“×™×¦'×‘", "××‘×˜×œ×™×•×Ÿ", "××‘×™×‘×™×", "××‘×™×’×™×œ", "××‘×™×©×™", "××‘×Ÿ ××‘×™×ª×•×¨", "××‘×Ÿ ×—×‘×™×‘", 
            "××‘×Ÿ ×¡×¤×™×¨", "××‘×Ÿ ×¢×–×¨×", "××‘× ×™ ×”×—×•×©×Ÿ", "××‘× ×¨ ×××™×¨", "××’××•×Ÿ ×¨××ª ××¤×¢×œ", "××”×•×“", 
            "××”×œ×™××‘", "××”×¨×•× ×¡×•×Ÿ ×©×¨×”", "××•× ×‘×¨×¡×™×˜×” ×‘×¨ ××™×œ×Ÿ", "××•×¨×”", "××•×¨×™ × ×™×¡×Ÿ", "××•×¨×Ÿ", 
            "××–×•×¨ ×”×‘×™×œ×•×™×™×", "××–×•×¨ ×”×ª×¢×©×™×”", "××—×“ ×”×¢×", "××—×™×××™×¨ ××‘×", "××™× ×©×˜×™×™×Ÿ", "××™×ª××¨", 
            "××™×ª×Ÿ ×™×•× ×”", "××œ ×¢×œ", "××œ ×¢×œ ×¨××ª ××¤×¢×œ", "××œ×•××•×ª ×¨××ª ××¤×¢×œ", "××œ×•× ×™×", "××œ×•×£ ×“×•×“", 
            "××œ×•×£ ×”× ×¦×—×•×Ÿ", "××œ×•×£ ×©×“×”", "××œ×•×£ ×©××—×•× ×™", "××œ×™××œ×š", "××œ×™×©×™×‘", "××œ×™×©×¢", "××œ×›×¡× ×“×¨", 
            "××œ×›×¡× ×“×¨×•× ×™", "××œ××•×’ ×¨××ª ××¤×¢×œ", "××œ×¨×•××™", "××œ×¨×•×", "×××™×¨", "××× ×•×Ÿ ×•×ª××¨", 
            "×× ×’×œ× ×“×¨ ×™×”×•×“×”", "×× ×” ×¤×¨× ×§", "×× ×§×•×¨×™×", "××¡×£", "××¤×¢×œ-××¨×›×– ×¡××™× ×¨×™×•× ×™", "××¤×¨×™×", 
            "××¦\"×œ", "××¨×’××Ÿ ×¨××ª ××¤×¢×œ", "××¨×œ×•×–×•×¨×•×‘", "××¨× ×•×Ÿ", "××¨× ×™×”", "××©×ª××•×œ", "×‘××“×¨ ×™×•×—× ×Ÿ", 
            "×‘××¨ ××•×¨×”", "×‘××¨ ×©×‘×¢", "×‘×“× ×¨", "×‘×•×¢×–", "×‘×•×¨×¡×”", "×‘×•×¨×¡×ª ×”×™×”×œ×•××™×", "×‘×™××œ×™×§", 
            "×‘×™×ª ××œ", "×‘×™×ª ×”×œ×œ", "×‘×™×ª ×”×¢×¨×‘×”", "×‘×™×ª ×—×•×¨×•×Ÿ", "×‘×™×ª ×œ×—×", "×‘×™×ª ×©×××™", 
            "×‘×Ÿ ××œ×™×¢×–×¨ ××¨×™×”", "×‘×Ÿ ×’×•×¨×™×•×Ÿ ×›×¤×¨ ××–\"×¨", "×‘×Ÿ ×™×•×¡×£", "×‘×Ÿ ×¡×¨×•×§", "×‘×Ÿ ×©××Ÿ", 
            "×‘× ×™ ×”× ×‘×™××™×", "×‘× ×™ ××©×”", "×‘× ×™×”×•", "×‘× ×™××™×Ÿ", "×‘×¢×œ ×©× ×˜×•×‘", "×‘×¦×œ××œ", "×‘×§×¢×ª ××¨×‘×œ", 
            "×‘×§×¢×ª ×’×™× ×•×¡×¨", "×‘×¨ ×’×™×•×¨×", "×‘×¨ ×™×•×—××™", "×‘×¨ ×›×•×›×‘×", "×‘×¨×•×“×¦×§×™", "×‘×¨×•×¨×™×”", "×‘×¨×•×©", 
            "×‘×¨× ×©×˜×™×™×Ÿ ×¤×¨×¥", "×‘×¨×§××™", "×‘×¨×§×ª ×¨××ª ××¤×¢×œ", "×‘×©××ª", "×‘×ª ×©×•×¢", "×’××•×œ×™×", "×’×‘×¢×ª ×’××•×œ×”", 
            "×’×‘×¢×ª ×”×‘×¨×•×©×™×", "×’×‘×¢×ª×™", "×’×“×¢×•×Ÿ", "×’×•×œ×•××‘", "×’×•×œ× ×™", "×’×•×¨×™ ×™×”×•×“×”", 
            "×’×™×‘×•×¨×™ ××œ×—××ª ×™×•×”\"×›", "×’×™×œ×“×¡×’×™×™×", "×’×¤×•× ×•×‘", "×’×¨×•×¤×™×ª ×¨××ª ××¤×¢×œ", "×’×¨× ×“×•×¡", "×’×¨×©×•×", 
            "×“\"×¨ ××œ×™×”×•", "×“\"×¨ ×›×”×Ÿ", "×“×‘", "×“×‘×•×¨×” ×”× ×‘×™××”", "×“×•×“", "×“×•×œ×‘ ×¨××ª ××¤×¢×œ", "×“×•× ×©", 
            "×“×™×™×Ÿ ××©×”", "×“×Ÿ", "×“×Ÿ ×©×•××¨×•×Ÿ", "×“× ×’×•×¨", "×“× ×™××œ", "×“×§×¨", "×“×¨×š ××‘× ×”×œ×œ", 
            "×“×¨×š ××©×›×•×œ", "×“×¨×š ×‘×’×™×Ÿ ×× ×—×", "×“×¨×š ×‘×Ÿ ×’×•×¨×™×•×Ÿ ×“×•×“", "×“×¨×š ×”× ×©×™× ×”×¨××©×•×Ÿ", 
            "×“×¨×š ×”×ª×¤×•×¦×•×ª", "×“×¨×š ×™×¦×—×§ ×¨×‘×™×Ÿ", "×“×¨×š ×œ×•×“", "×“×¨×š × ×’×‘×”", "×“×¨×š ×©×™×‘×", "×“×¨×š ×©×©×ª ×”×™××™×", 
            "×” ×‘××™×™×¨ ×›×¤×¨ ××–\"×¨", "×”××’×“×”", "×”××’×•×– ×¨××ª ××¤×¢×œ", "×”××•×›×× ×™×•×ª ×¨××ª ××¤×¢×œ", "×”××•×¨×™×", 
            "×”××—×•×ª ×—×™×”", "×”××—×™× ×‘×–'×¨× ×•", "×”××—×™× ×œ×™×˜×•×™× ×¡×§×™", "×”××˜×“ ×¨××ª ××¤×¢×œ", "×”××™×œ× ×•×ª", 
            "×”××œ×” ×¨××ª ××¤×¢×œ", "×”××œ×•×Ÿ ×¨××ª ××¤×¢×œ", "×”××", "×”×××•×¨××™×", "×”××¨\"×™", "×”××¨×–", "×”××©\"×œ", 
            "×”××©×œ ×¨××ª ××¤×¢×œ", "×”××ª×¨×•×’ ×¨××ª ××¤×¢×œ", "×”×‘××¨", "×”×‘×•× ×™×", "×”×‘×™×œ×•×™×™×", "×”×‘× ×™×", 
            "×”×‘× ×™× ×›×¤×¨ ××–\"×¨", "×”×‘×©×Ÿ", "×”×’××•×Ÿ ××œ×™×”×•", "×”×’×•×œ×Ÿ", "×”×’×œ×’×œ", "×”×’×¤×Ÿ", "×”×’×ª", 
            "×”×“×•×“××™× ×¨××ª ××¤×¢×œ", "×”×“×¡", "×”×“×§×œ×™×", "×”×“×¨", "×”×“×¨×•×¨×™×", "×”×”×’× ×”", "×”×”×’× ×” ×›×¤×¨ ××–\"×¨", 
            "×”×”×œ×›×”", "×”×•×©×¢", "×”×–×™×ª×™×", "×”×–××™×¨", "×”×—×•×’×” ×¨××ª ××¤×¢×œ", "×”×—×•×œ×”", "×”×—×™\"×œ", 
            "×”×—×™×™×œ ×”××œ××•× ×™", "×”×—×™×œ×–×•×Ÿ", "×”×—×™×¦×•×Ÿ", "×”×—×¥", "×”×—×¦×‘ ×¨××ª ××¤×¢×œ", "×”×—×¨×•×‘ ×¨××ª ××¤×¢×œ", 
            "×”×—×¨×•×©×ª", "×”×—×¨××•×Ÿ", "×”×—×¨×¦×™×ª ×¨××ª ××¤×¢×œ", "×”×—×©××•× ××™×", "×”×˜×™×™×¡×™×", "×”×™×“ ×”×—×–×§×”", 
            "×”×™×•×‘×œ ×›×¤×¨ ××–\"×¨", "×”×™×•×’×‘", "×”×™×–××”", "×”×™×¡××™×Ÿ ×¨××ª ××¤×¢×œ", "×”×™×¦×™×¨×”", "×”×™×¨×“×Ÿ", "×”×™×ª×“", 
            "×”×›×‘××™×", "×”×œ×•×˜×•×¡ ×¨××ª ××¤×¢×œ", "×”×œ×¤×™×“", "×”×××” ×•××—×“", "×”×××™×¨×™", "×”××‘×“×™×œ", "×”××—×ª×¨×ª", 
            "×”××™×ª×¨", "×”××›×‘×™", "×”××œ××›×”", "×”××œ×š ×™×•×¡×£", "×”××œ×š ×™× ××™", "×”××¢×’×œ", "×”××¢×™×™×Ÿ", "×”××¢×¤×™×œ", 
            "×”××¦×™×™\"×¨", "×”××§×•×¨", "×”××¨×’× ×™×ª", "×”××©×˜×¨×”", "×”××ª××™×“", "×”× ×’×™×“", "×”× ×—\"×œ", 
            "×”× ×—\"×œ ×›×¤×¨ ××–\"×¨", "×”× ×¢×•×¨×™×", "×”× ×¦×™\"×‘ ×¨××ª ××¤×¢×œ", "×”×¡×•×œ×", "×”×¡× ×”", "×”×¡×¤××¨×™", 
            "×”×¡×¨×Ÿ ×“×‘", "×”×¢××œ", "×”×¢×¦×××•×ª ×›×¤×¨ ××–\"×¨", "×”×¢×¨×‘×” ×¨××ª ××¤×¢×œ", "×”×¤××¨×§ ×”×œ××•××™", "×”×¤×•×“×™×", 
            "×”×¤×•×¨×¦×™×", "×”×¤×˜××Ÿ", "×”×¤×œ×\"×— ×›×¤×¨ ××–\"×¨", "×”×¤×¨×’×™× ×¨××ª ××¤×¢×œ", "×”×¤×¨×¡×”", "×”×¦×œ×¢", 
            "×”×¨×\"×”", "×”×¨××‘\"×¢", "×”×¨××•×‘× ×™", "×”×¨××œ", "×”×¨××©×•× ×™×", "×”×¨×‘ ×”××œ×•×£ ×’×•×¨×Ÿ", "×”×¨×‘ ×—×‘×” ××œ×™×”×•", 
            "×”×¨×‘ ×—×™ ×˜×™×™×‘ ×™×¦×—×§", "×”×¨×‘ ×œ×•×™×Ÿ", "×”×¨×‘ ×œ× ×“×¨×¡", "×”×¨×‘×™ ××¨×™×–'×™×Ÿ", "×”×¨×“×•×£ ×¨××ª ××¤×¢×œ", 
            "×”×¨×™ ×”×’×œ×¢×“", "×”×¨×™××•×Ÿ", "×”×¨×›×¡×™×", "×”×¨×¦×œ", "×”×¨×§×•×Ÿ", "×”×¨×§×¤×ª ×¨××ª ××¤×¢×œ", "×”×¨×¨×™", "×”×©×•×˜×¨×ª", 
            "×”×©×•××¨", "×”×©×•××¨ ×›×¤×¨ ××–\"×¨", "×”×©×•×¨×”", "×”×©×•×©×Ÿ", "×”×©×™×˜×” ×¨××ª ××¤×¢×œ", "×”×©×œ×•×©×™× ×•×©×œ×•×©×”", 
            "×”×©×§×“ ×¨××ª ××¤×¢×œ", "×”×©×§××”", "×”×©×¨ ××©×”", "×”×ª× ××™×", "×”×ª×§×•×”", "×•×™×™× ×©×œ ××œ×™×¢×–×¨", "×–\"×¨", 
            "×–'×‘×•×˜×™× ×¡×§×™", "×–×•×”×¨", "×–×™×¡××Ÿ ×©×œ×•×", "×–×›×¨×™×”", "×—×‘×¦×œ×ª", "×—×‘×§×•×§", "×—×‘×¨", "×—×‘×¨×•×Ÿ", "×—×’×™", 
            "×—×“ × ×¡", "×—×•×¨×’×™×Ÿ", "×—×–×•×Ÿ ××™\"×©", "×—×™×‘×ª ×¦×™×•×Ÿ", "×—×™×™× ×‘×¨-×œ×‘", "×—××™ ×–×›×¨×™×”", "×—××™×¨", 
            "×—×¦×•×¨", "×—×¨×•×“", "×—×¨×•×–×™×", "×—×¨×•×ª", "×˜×‘× ×§×™×Ÿ", "×˜×•×¨ ×”×‘×¨×•×©×™×", "×˜×¨×•××Ÿ", "×™\"× ×‘××“×¨", 
            "×™××™×¨", "×™×‘× ×”", "×™×“ ×œ×‘× ×™×", "×™×“ ×©×œ×•×", "×™×“×™×“×™×”", "×™×“×¢ ×¢×", "×™×”×•×“×” ×”× ×©×™×", "×™×”×•×“×™×ª", 
            "×™×”×•×©×¢ ×‘×Ÿ × ×•×Ÿ", "×™×”×•×©×¤×˜", "×™×”×œ×•× ×¨××ª ××¤×¢×œ", "×™×•××‘", "×™×•×—× ×Ÿ", "×™×•× ×”", "×™×•×¡×£ ×”×’×œ×™×œ×™", 
            "×™×•×¡×£ ×¦×‘×™", "×™×•×¡×¤×™", "×™×—×–×§××œ", "×™×›×™×Ÿ", "×™×¢×‘×¥", "×™×¢×œ ×”×’×‘×•×¨×”", "×™×¢×œ×™×", "×™×¢×¨×”", 
            "×™×¨×™×—×•", "×™×¨××™×”", "×™×©×•×¨×•×Ÿ", "×™×©×¢×™×”×•", "×›×‘×™×© × ×ª×™×‘×™ ××™×œ×•×Ÿ", "×›×‘×™×© ×¢×•×§×£", "×›×”×Ÿ ×™×¢×§×‘", 
            "×›×›×¨ ×’×¨×•× ×¨", "×›×›×¨ ×”×œ×•×—××™×", "×›×›×¨ ×”×¢×¦×××•×ª", "×›×›×¨ ×”×¦×‘×™", "×›×›×¨ ×”×¦×™×•× ×•×ª", "×›×›×¨ ×”×¨×‘ ×¤×¨×“×¡", 
            "×›×›×¨ ×™×”×•×“×”", "×›×›×¨ × ×•×¨×™ ××•×¨×“", "×›×›×¨ ×¢×•×–×™ ×—×™×˜××Ÿ", "×›×›×¨ ×¨××‘\"×", "×›× ×¤×™ × ×©×¨×™×", "×›× ×¨×ª", 
            "×›×£ ×’×™××œ", "×›×¤×¨ ××–\"×¨", "×›×¤×¨ ×”××›×‘×™×”", "×›×¤×¨ ××¡×•×‘×™× ×¨××ª ××¤×¢×œ", "×›×¨××œ×™", "×œ××Ÿ", 
            "×œ×‘ ×”×–×”×‘", "×œ×‘×•× ×” ×¨××ª ××¤×¢×œ", "×œ×‘×™×", "×œ×•×—××™ ×¡×™× ×™", "×œ×•×™", "×œ×•×™×˜×”", "×œ×—\"×™", 
            "×œ×™×™×‘ ×™×¤×”", "×œ× ×“××• ×—×™×™×", "×××™×¨ ×‘×¢×œ ×”× ×¡", "××‘×•× ×× ×” ×¤×¨× ×§", "××‘×•× ××¨×™×”", "××‘×•× ×“×•×“", 
            "××‘×•× ×”×¢××œ", "××‘×•× ×”×¤×•×“×™×", "××‘×•× ×”×§×•× ×’×¨×¡", "××‘×•× ×”×¨×™××•×Ÿ", "××‘×•× ×”×ª×™×›×•×Ÿ", "××‘×•× ×–××‘", 
            "××‘×•× ×—×¨××•×Ÿ", "××‘×•× ×™×”×œ\"×", "××‘×•× ×× ×“×¡", "××‘×•× × ×’×‘×”", "××‘×•× × ×¡", "××‘×•× × ×ª×Ÿ", 
            "××‘×¦×¢ ×¢×™×Ÿ", "××‘×¦×¢ ×§×“×©", "××’×“×™×", "××•×“×¢×™ ×™×¦×—×§", "××•×–×¡ × ×—", "××•×œ×›×•", "××•×¦×", 
            "××•×¨×“×™ ×”×’×˜××•×ª", "××•×¨×™×”", "××—×•×œ×” ×¨××ª ××¤×¢×œ", "××—× ×™×™×", "××—×¥", "××˜×” ××”×¨×•×Ÿ", "××˜×•×œ×”", 
            "××™×›××œ", "××™×›×”", "××™×¨×§×™×Ÿ", "××œ\"×œ", "××œ××›×™", "××œ×—×™ ×©×œ××”", "××œ×›×™ ×¦×“×§", "×× ×“×œ ××ª×ª×™×”×•", 
            "×× ×“×¡", "×× ×—×", "×× ×—× ×™×¦×—×§", "×× ×©×”", "××¢×œ×” ×”×‘× ×™×", "××¢×œ×” ×”× ×©×¨", "××¢×œ×” ×”×¦×‘×™", 
            "××¢×œ×” ×”×¦×•×¤×™×", "××¢×œ×” ×”×©×•××‘×”", "××¢×œ×” ×”×©×—×¨", "××¦×“×”", "××¦×¤×”", "××§×“×•× ×œ×“", "××§×¡ ×•×× ×” ×•×•×‘", 
            "××¨×“×›×™", "××¨×™×", "××¨×›×– ×¨×¤×•××™ ×¢\"×© ×©×™×‘×", "××©×•××” ×¨××ª ××¤×¢×œ", "××©××¨ ×”×™×¨×“×Ÿ", 
            "××©×¢×•×œ ×¡×¤×¨××™", "××ª×—× ×”××™×¦×˜×“×™×•×Ÿ", "××ª×—× ××¡×•×‘×™×", "××ª×—× × ×’×‘×”", "××ª×—× ×§× ×™×•×Ÿ ××™×™×œ×•×Ÿ", 
            "××ª× ×™×”", "× ×‘×˜×™× ×¨××ª ××¤×¢×œ", "× ×“×•× ×™ ×§×”×™×¨", "× ×”×¨×“×¢×", "× ×•×” ×™×”×•×©×¢", "× ×•×” ×™×¢×§×‘", 
            "× ×•×•×” ××¤×¢×œ", "× ×•×¨×“××•", "× ×•×¨×™×ª", "× ×•×¨×™×ª ×¨××ª ××¤×¢×œ", "× ×—×•×", "× ×—×œ×”", "× ×—×œ×™××œ×™", 
            "× ×—×œ×ª ×™×•×¡×£", "× ×—×©×•×Ÿ", "× ×˜×¨", "× ×¥", "× ×¦× ×™×", "× ×¨×“×™××•×Ÿ", "× ×©×™××™ ×™×©×¨××œ", "× ×ª×Ÿ", "×¡××œ×§", 
            "×¡×‘×™×•×Ÿ", "×¡×•×§×•×œ×•×‘", "×¡×•×¨×", "×¡×˜×•×¤", "×¡×˜×¨×•××”", "×¡×™×’×œ×™×ª", "×¡×™×™×¨×ª ×“×•×›×™×¤×ª", "×¡× ××™×œ×•×Ÿ", 
            "×¡× ××œ×‘×¨×˜", "×¡× ×‘×“×© ×¦×™×•×Ÿ", "×¡× ×‘×¨×§×ª ×¨\"×", "×¡× ×”×‘××¨", "×¡× ×”×™×¡××™×Ÿ", "×¡× ×”××¢×œ×•×ª", 
            "×¡× ×”×©×œ×•×—", "×¡× ×”×ª×œ××™×“", "×¡× ×™×¤×ª×—", "×¡× ×œ×‘× ×™", "×¡× ×¡×¤×™×¨ ×¨××ª ××¤×¢×œ", "×¡× ×¢××§ ×”××œ×”", 
            "×¡× ×§×¨×Ÿ", "×¡× ×©×¢×¨ ×”×’×™×", "×¡××“×¨", "×¡××˜×ª ×§\"×", "×¡×Ÿ ××¨×˜×™×Ÿ", "×¡× ×”×“×¨×™×Ÿ", "×¡× ×© ×—× ×”", 
            "×¡×¤×™×¨ ×™×•×¡×£", "×¡×¤×™×¨ ×¨××ª ××¤×¢×œ", "×¢×•×‘×“×™×”", "×¢×•×“×“", "×¢×•×–×™××œ", "×¢×•×œ×™ ×”×’×¨×“×•×", "×¢×–×¨×™××œ", 
            "×¢×˜×¨×•×ª", "×¢×™×“×•", "×¢×™×Ÿ ×™×”×‘", "×¢×™×¨ ×’× ×™×", "×¢×œ×•××™×", "×¢×œ×™×” ×¨××©×•× ×”", "×¢×œ×™×” ×©×œ×™×©×™×ª", 
            "×¢×œ×™×” ×©× ×™×”", "×¢×œ×™×ª ×”× ×•×¢×¨", "×¢××•×¡", "×¢××™× ×“×‘", "×¢××™×§×", "×¢××§ ×“×•×ª×Ÿ", "×¢××§ ×”××œ×”", 
            "×¢××§ ×”××¨×–×™×", "×¢×¦×™×•×Ÿ", "×¢×¨××•× ×™×", "×¤×‘×¨×™×’×˜", "×¤×•××‘×“×™×ª×", "×¤×œ×™\"× ×›×¤×¨ ××–\"×¨", "×¤× ×—×¡", 
            "×¤× ×™ ×”×’×‘×¢×”", "×¤× ×§×¡", "×¤×¨×•×’ ×©××¢×•×Ÿ", "×¤×¨×•×¤×¡", "×¤×ª×™×™×”", "×¦××œ×™×", "×¦××œ×™× ×¨××ª ××¤×¢×œ", "×¦×‘×™", 
            "×¦×”\"×œ ×›×¤×¨ ××–\"×¨", "×¦×•××ª ×œ×‘×‘×™", "×¦×•×¤×¨ ×¨××ª ××¤×¢×œ", "×¦×•×¨ ×¨××ª ××¤×¢×œ", "×¦×•×¨×™××œ", 
            "×¦×œ ×”×’×‘×¢×”", "×¦×¤× ×™×”", "×§××¨×• ×™×•×¡×£", "×§×“××”", "×§×“×¨×•×Ÿ", "×§×•×××™×•×ª", "×§×™×©", "×§×œ××•×–× ×¨", 
            "×§×œ×™×¨ ××‘×¨×”× ×•× ×¢×™××”", "×§× ×™×•×Ÿ ××™×œ×•×Ÿ", "×§×¤×œ×Ÿ", "×§×¦×™×¢×” ×¨××ª ××¤×¢×œ", "×§×¦×™×¨", "×§×¨×™×™×ª×™", 
            "×§×¨×™× ×™×¦×™", "×§×¨×™×ª ×‘×•×¨×•×›×•×‘", "×§×¨×™×ª ×’×Ÿ", "×§×¨×™×ª ×¡×’×œ × ×•×•×” ××¤×¢×œ", "×§×¨×™×ª ×§×¨×™× ×™×¦×™", "×§×¨×¡×§×™", 
            "×¨××© ×¤× ×”", "×¨×‘×“×™×", "×¨×‘×™", "×¨×“\"×§", "×¨×•×“×™×Ÿ", "×¨×•×–×Ÿ", "×¨×•×—××”", "×¨×•×§×—", "×¨×•×ª", "×¨×•×ª×", 
            "×¨×–×™××œ", "×¨×—×•×‘×•×ª ×”× ×”×¨", "×¨×™×™×§ ×—×‘×™×‘×”", "×¨×™××•×Ÿ ×¨××ª ××¤×¢×œ", "×¨×™××œ×˜ ××œ×™××œ×š", "×¨××‘×”", "×¨××–", 
            "×¨××ª ××¤×¢×œ", "×¨××ª ×’×Ÿ", "×¨××ª ×—×Ÿ", "×¨××ª ×¢××™×“×¨", "×¨××ª ×©×™×§××”", "×¨× × ×™×", 
            "×¨×¤××œ ××™×ª×Ÿ ×›×¤×¨ ××–\"×¨", "×¨×§×¤×ª", "×¨×©\"×™", "×© ××—×™×•×ª", "×© ××§×“×××™×", "×© ×’×¨×™×Ÿ", 
            "×© ×”×‘×•×œ×’×¨×™×", "×© ×”×¤×•××–", "×© ×—×¨×•×ª", "×© ××–×¨×—×™", "×© ××¤×“×” ××–×¨×—×™", "×© ××©×›× ×•×ª", "×© ×¡×œ××”", 
            "×© ×¡×œ××” ××–×¨×™×¥", "×© ×¡×œ×¢", "×© ×¢×™×¨×•× ×™", "×© ×¢×××™ ×¨×¡×§×•", "×© ×¢××§ ×“×•×ª×Ÿ", "×© ×¤×¨×“×¡ ××‘×¨×œ×”", 
            "×© ×¤×¨×•×’×¨×¡×™×‘×™×", "×© ×¦×‘× ×§×‘×¢", "×© ×¦× ×—× ×™×", "×© ×¨××ª ×™×¦×—×§", "×© ×¨×¡×§×•", "×©\"×™ ×¢×’× ×•×Ÿ", 
            "×©×× ×Ÿ", "×©××¨ ×™×©×•×‘", "×©×“ ××‘×¨×”×", "×©×“ ×‘×Ÿ ×¦×‘×™", "×©×“ ×”××•×¨× ×™× ×¨××ª ××¤×¢×œ", 
            "×©×“ ×”××¨×–×™× ×¨××ª ××¤×¢×œ", "×©×“ ×”×‘×¨×•×©×™× ×¨××ª ××¤×¢×œ", "×©×“ ×”×’×‘×•×¨×™×", "×©×“ ×”×˜×™×™×¡", "×©×“ ×”×™×œ×“", 
            "×©×“ ×”×›×œ× ×™×•×ª", "×©×“ ×”× ×¨×§×™×¡×™×", "×©×“ ×”×¢× ×”×¦×¨×¤×ª×™", "×©×“ ×”×¦× ×—× ×™×", "×©×“ ×”×§×•× ×’×¨×¡", "×©×“ ×”×©×—×¨×•×¨", 
            "×©×“ ×”×ª××¨×™×", "×©×“ ×˜×•×‘×™×", "×©×“ ×™×”×“×•×ª ×¤×™×œ×“×œ×¤×™×”", "×©×“ ×™×¨×•×©×œ×™×", "×©×“ ×œ××“×Ÿ", "×©×“ × ×—××”", 
            "×©×“ ×§\"×", "×©×“×¨×•×ª ×”×¦×‘×™", "×©×“×¨×•×ª ×•×™×¦\"×•", "×©×“×¨×ª ×’×™×“×™", "×©×•×”×", "×©×•×¢×œ×™ ×©××©×•×Ÿ", "×©×•×©× ×™×", 
            "×©×–\"×¨", "×©×—× ×¨××ª ××¤×¢×œ", "×©×™××•×Ÿ", "×©×™×›×•×Ÿ ×‘× ×™× ×›×¤×¨ ××–\"×¨", "×©×™×›×•×Ÿ ×•×ª×™×§×™×", "×©×™×›×•×Ÿ ×¢×œ×™×ª", 
            "×©×™×œ×”", "×©×› ×‘×¨ ××™×œ×Ÿ", "×©×› ×’×‘ ×’××•×œ×”", "×©×› ×’×¤×Ÿ", "×©×› ×”×œ×œ", "×©×› ×—×¨×•×–×™×", "×©×› ××¨×•× × ×•×•×”", 
            "×©×› × ×—×œ×ª ×’× ×™×", "×©×› ×§ ×‘×•×¨×•×›×•×‘", "×©×› ×¨××©×•× ×™×", "×©×› ×©×¤×™×¨×", "×©×› ×ª×œ ×’× ×™×", "×©×› ×ª×œ ×™×”×•×“×”", 
            "×©×›×˜×¨××Ÿ ×¨××ª ××¤×¢×œ", "×©×œ×•× ×¢×œ×™×›×", "×©×œ×•××¦×™×•×Ÿ", "×©×œ×", "×©××•××œ×™", "×©××—×”", "×©××¢×•× ×™", 
            "×©××¨×œ×™× ×’"
        ];

        // ×˜×¢×™× ×ª ×¨×©×™××ª ×”×¨×—×•×‘×•×ª
        window.addEventListener('DOMContentLoaded', () => {
            // ××™×Ÿ ×¦×•×¨×š ×œ×˜×¢×•×Ÿ ×¨×©×™××” × ×¤×ª×—×ª - × ×¢×©×” ×–××ª ×“×™× ××™×ª
            setupStreetSearch();
            
            // ×˜×¢×™× ×ª ×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×™×•×
            loadTodayStats();
        });
        
        // ×”×’×“×¨×ª ×—×™×¤×•×© ×¨×—×•×‘×•×ª
        function setupStreetSearch() {
            const searchInput = document.getElementById('streetSearch');
            const hiddenInput = document.getElementById('street');
            const dropdown = document.getElementById('streetDropdown');
            
            // ×›×©×œ×•×—×¦×™× ×¢×œ ×”×©×“×” - ××¦×™×’×™× ××ª ×›×œ ×”×¨×—×•×‘×•×ª
            searchInput.addEventListener('focus', () => {
                showAllStreets();
            });
            
            // ×›×©××§×œ×™×“×™× - ××¡× × ×™×
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.trim();
                
                if (searchTerm === '') {
                    showAllStreets();
                } else {
                    filterStreets(searchTerm);
                }
            });
            
            // ×¡×’×™×¨×ª ×”×¨×©×™××” ×›×©×œ×•×—×¦×™× ××—×•×¥ ×œ×”
            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            });
        }
        
        // ×”×¦×’×ª ×›×œ ×”×¨×—×•×‘×•×ª
        function showAllStreets() {
            const dropdown = document.getElementById('streetDropdown');
            dropdown.innerHTML = '';
            
            streets.forEach(street => {
                const option = document.createElement('div');
                option.className = 'street-option';
                option.textContent = street;
                option.addEventListener('click', () => selectStreet(street));
                dropdown.appendChild(option);
            });
            
            dropdown.classList.add('show');
        }
        
        // ×¡×™× ×•×Ÿ ×¨×—×•×‘×•×ª ×œ×¤×™ ×—×™×¤×•×©
        function filterStreets(searchTerm) {
            const dropdown = document.getElementById('streetDropdown');
            dropdown.innerHTML = '';
            
            const filtered = streets.filter(street => 
                street.includes(searchTerm) || 
                street.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            if (filtered.length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'no-results';
                noResults.textContent = '×œ× × ××¦××• ×¨×—×•×‘×•×ª';
                dropdown.appendChild(noResults);
            } else {
                filtered.forEach(street => {
                    const option = document.createElement('div');
                    option.className = 'street-option';
                    option.textContent = street;
                    option.addEventListener('click', () => selectStreet(street));
                    dropdown.appendChild(option);
                });
            }
            
            dropdown.classList.add('show');
        }
        
        // ×‘×—×™×¨×ª ×¨×—×•×‘
        function selectStreet(street) {
            const searchInput = document.getElementById('streetSearch');
            const hiddenInput = document.getElementById('street');
            const dropdown = document.getElementById('streetDropdown');
            
            searchInput.value = street;
            searchInput.classList.add('has-value');
            hiddenInput.value = street;
            dropdown.classList.remove('show');
        }

        // ×¤×•× ×§×¦×™×•×ª ×œ×”×•×¡×¤×” ×•×”×¤×—×ª×” ×©×œ ×¤×—×™×
        window.incrementBins = function() {
            const input = document.getElementById('binCount');
            input.value = parseInt(input.value) + 1;
        };

        window.decrementBins = function() {
            const input = document.getElementById('binCount');
            if (parseInt(input.value) > 0) {
                input.value = parseInt(input.value) - 1;
            }
        };
        
        // ×§×‘×œ×ª ××™×§×•× GPS ×•×××™×¨ ×œ×›×ª×•×‘×ª
        window.getLocation = function() {
            const statusDiv = document.getElementById('locationStatus');
            
            if (!navigator.geolocation) {
                statusDiv.textContent = 'âŒ ×”×“×¤×“×¤×Ÿ ×œ× ×ª×•××š ×‘-GPS';
                statusDiv.style.display = 'block';
                return;
            }
            
            statusDiv.textContent = 'ğŸ” ×××ª×¨ ××™×§×•×...';
            statusDiv.style.display = 'block';
            
            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    
                    statusDiv.textContent = 'ğŸ“ ××—×¤×© ×›×ª×•×‘×ª...';
                    
                    try {
                        // ×©×™××•×© ×‘-Nominatim API (×—×™× ××™) ×œ××¦×™××ª ×›×ª×•×‘×ª
                        const response = await fetch(
                            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&addressdetails=1&accept-language=he`,
                            {
                                headers: {
                                    'User-Agent': 'RamatGanBinsApp/1.0'
                                }
                            }
                        );
                        
                        const data = await response.json();
                        console.log('Location data:', data);
                        
                        if (data.address) {
                            const road = data.address.road || data.address.street || '';
                            const houseNumber = data.address.house_number || '';
                            
                            if (road) {
                                // ×—×™×¤×•×© ×”×¨×—×•×‘ ×”×§×¨×•×‘ ×‘×™×•×ª×¨ ×‘×¨×©×™××”
                                const matchingStreet = findClosestStreet(road);
                                
                                if (matchingStreet) {
                                    selectStreet(matchingStreet);
                                    statusDiv.textContent = `âœ… × ××¦×: ${matchingStreet}`;
                                } else {
                                    document.getElementById('streetSearch').value = road;
                                    statusDiv.textContent = `âš ï¸ × ××¦×: ${road} (×œ× ×‘×¨×©×™××” - ×‘×—×¨ ×™×“× ×™×ª)`;
                                }
                                
                                if (houseNumber) {
                                    document.getElementById('houseNumber').value = houseNumber;
                                }
                            } else {
                                statusDiv.textContent = 'âš ï¸ ×œ× × ××¦× ×©× ×¨×—×•×‘ - × ×¡×” ×©×•×‘ ××• ×‘×—×¨ ×™×“× ×™×ª';
                            }
                            
                            setTimeout(() => {
                                statusDiv.style.display = 'none';
                            }, 5000);
                        }
                    } catch (error) {
                        console.error('Geocoding error:', error);
                        statusDiv.textContent = 'âŒ ×©×’×™××” ×‘××¦×™××ª ×›×ª×•×‘×ª';
                        setTimeout(() => {
                            statusDiv.style.display = 'none';
                        }, 3000);
                    }
                },
                (error) => {
                    console.error('GPS error:', error);
                    let errorMsg = 'âŒ ×œ× ×”×¦×œ×—× ×• ×œ×§×‘×œ ××™×§×•×';
                    
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg = 'âŒ ×™×© ×œ××¤×©×¨ ×’×™×©×” ×œ××™×§×•× ×‘×”×’×“×¨×•×ª';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg = 'âŒ ×”××™×§×•× ×œ× ×–××™×Ÿ';
                            break;
                        case error.TIMEOUT:
                            errorMsg = 'âŒ ×ª× ×”×–××Ÿ - × ×¡×” ×©×•×‘';
                            break;
                    }
                    
                    statusDiv.textContent = errorMsg;
                    setTimeout(() => {
                        statusDiv.style.display = 'none';
                    }, 3000);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        };
        
        // ××¦×™××ª ×”×¨×—×•×‘ ×”×§×¨×•×‘ ×‘×™×•×ª×¨ ×‘×¨×©×™××”
        function findClosestStreet(streetName) {
            streetName = streetName.trim();
            
            // ×—×™×¤×•×© ×”×ª×××” ××“×•×™×§×ª
            const exactMatch = streets.find(s => s === streetName);
            if (exactMatch) return exactMatch;
            
            // ×—×™×¤×•×© ×”×ª×××” ×—×œ×§×™×ª
            const partialMatch = streets.find(s => 
                s.includes(streetName) || streetName.includes(s)
            );
            if (partialMatch) return partialMatch;
            
            // × ×™×§×•×™ ×©× ×”×¨×—×•×‘ ××ª×—×™×œ×™×•×ª ××™×•×ª×¨×•×ª
            const cleanedName = streetName
                .replace(/^×¨×—×•×‘\s+/i, '')
                .replace(/^×¨×—['×³]\s*/i, '')
                .replace(/^×©×“['×³]?\s*/i, '');
            
            const cleanMatch = streets.find(s => 
                s.includes(cleanedName) || cleanedName.includes(s)
            );
            if (cleanMatch) return cleanMatch;
            
            return null;
        }

        // ×˜×¢×™× ×ª ×¡×˜×˜×™×¡×˜×™×§×•×ª ×©×œ ×”×™×•×
        async function loadTodayStats() {
            try {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const todayTimestamp = today.getTime();
                
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                const tomorrowTimestamp = tomorrow.getTime();
                
                const binCountingRef = ref(database, 'bin_counting');
                const snapshot = await get(binCountingRef);
                
                let count = 0;
                if (snapshot.exists()) {
                    snapshot.forEach((childSnapshot) => {
                        const data = childSnapshot.val();
                        if (data.timestamp >= todayTimestamp && data.timestamp < tomorrowTimestamp) {
                            count++;
                        }
                    });
                }
                
                document.getElementById('todayCount').textContent = count;
                console.log('Today count updated:', count);
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // ×˜×™×¤×•×œ ×‘×©×œ×™×—×ª ×”×˜×•×¤×¡
        document.getElementById('binForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const street = document.getElementById('street').value;
            const houseNumber = document.getElementById('houseNumber').value;
            const binCount = parseInt(document.getElementById('binCount').value);
            const notes = document.getElementById('notes').value;
            
            // ×•×™×“×•× ×©× ×‘×—×¨ ×¨×—×•×‘
            if (!street) {
                alert('×× × ×‘×—×¨ ×¨×—×•×‘ ××”×¨×©×™××”');
                return;
            }
            
            // ×”×¦×’×ª loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            
            try {
                // ×™×¦×™×¨×ª ××•×‘×™×™×§×˜ ×”× ×ª×•× ×™×
                const reportData = {
                    street: street,
                    houseNumber: houseNumber,
                    binCount: binCount,
                    notes: notes,
                    timestamp: Date.now(),
                    date: new Date().toLocaleDateString('he-IL'),
                    time: new Date().toLocaleTimeString('he-IL')
                };
                
                // ×©××™×¨×” ×‘-Firebase
                const binCountingRef = ref(database, 'bin_counting');
                const newReportRef = push(binCountingRef);
                await set(newReportRef, reportData);
                
                // ×”×¦×œ×—×”!
                document.getElementById('loading').style.display = 'none';
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('submitBtn').disabled = false;
                
                // ××™×¤×•×¡ ×”×˜×•×¤×¡
                document.getElementById('binForm').reset();
                document.getElementById('binCount').value = '0';
                document.getElementById('streetSearch').value = '';
                document.getElementById('streetSearch').classList.remove('has-value');
                document.getElementById('street').value = '';
                
                // ×¢×“×›×•×Ÿ ×”×¡×˜×˜×™×¡×˜×™×§×•×ª - ×¢× ×”×©×”×™×” ×§×¦×¨×” ×›×“×™ ×œ×•×•×“× ×©×”× ×ª×•× ×™× × ×©××¨×•
                setTimeout(() => {
                    loadTodayStats();
                }, 500);
                
                // ×”×¡×ª×¨×ª ×”×•×“×¢×ª ×”×”×¦×œ×—×” ××—×¨×™ 3 ×©× ×™×•×ª
                setTimeout(() => {
                    document.getElementById('successMessage').style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('Error saving report:', error);
                console.error('Error details:', error.message);
                console.error('Error code:', error.code);
                
                document.getElementById('loading').style.display = 'none';
                const errorMsg = document.getElementById('errorMessage');
                errorMsg.textContent = `âŒ ×©×’×™××”: ${error.message || '×©×’×™××” ×œ× ×™×“×•×¢×”'}`;
                errorMsg.style.display = 'block';
                document.getElementById('submitBtn').disabled = false;
                
                // Don't hide error message automatically so user can read it
            }
        });
    </script>
</body>
</html>
